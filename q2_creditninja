/* 2.A*/
select sum(totalamount) / (select sum(totalamount) from summarytable)
from summarytable
group by customer_type


/* 2.B*/
select category_name, count(*)/ (select count(totalamount) from summarytable), sum(totalamount)/ (select sum(totalamount) from summarytable)
from summarytable
group by category_name


/* 2.C
c.	What is the monthly revenue and what is the cumulative revenue 
as of each month within a year (cumulative revenue resets at the beginning of each year)?
*/
select extract(YEAR FROM orderdate) as year,
		extract(YEAR_MONTH FROM orderdate) as year_month,
		sum(totalamount) as year_sum,
		(select sum(st.totalamount)
		from summarytable st
		where extract(year_month from st.orderdate) <= year_month and
		extract(YEAR from st.orderdate) = year
		) as cumulative_revenue_as_of_each_month
FROM summarytable
group by year_month

/* 2.D*/
select case when age < 20 then '<20'
			when age >= 20 and age < 30 then '20-30'
			when age >= 30 and age < 40 then '30-40'
			when age >= 40 and age < 50 then '40-50'
			when age >= 50 and age < 60 then '50-60'
			when age >= 60 and age < 70 then '60-70'
			when age >= 70 and age < 80 then '70-80'
			when age >= 80 and age < 90 then '80-90'
			when age >= 90 then '>90'
		end as customer_age_buckets, 
		sum(totalamount) / (select sum(totalamount) from summarytable) as sales_freq
		from (select age, totalamount from summarytable) as tmp_q2d
		group by customer_age_buckets